syntax = "proto3";

package lumera.audit.v1;

import "cosmos_proto/cosmos.proto";

option go_package = "x/audit/v1/types";

enum EvidenceType {
  EVIDENCE_TYPE_UNSPECIFIED = 0;
  EVIDENCE_TYPE_ACTION_WRONG_FINALIZATION = 1;
  EVIDENCE_TYPE_ACTION_EXPIRED = 2;
}

// Evidence is a stable outer record that stores evidence about an audited subject.
// Type-specific fields are encoded into the `metadata` bytes field.
message Evidence {
  // evidence_id is a chain-assigned unique identifier.
  uint64 evidence_id = 1;

  // subject_address is the audited subject (e.g. supernode-related actor).
  string subject_address = 2 [(cosmos_proto.scalar) = "cosmos.AddressString"];

  // reporter_address is the submitter of the evidence.
  string reporter_address = 3 [(cosmos_proto.scalar) = "cosmos.AddressString"];

  // action_id optionally links this evidence to a specific action.
  string action_id = 4;

  // evidence_type is a stable discriminator used to interpret metadata.
  EvidenceType evidence_type = 5;

  // metadata is protobuf-binary bytes of a type-specific Evidence metadata message.
  bytes metadata = 6;

  // reported_height is the block height when the evidence was submitted.
  uint64 reported_height = 7;
}

