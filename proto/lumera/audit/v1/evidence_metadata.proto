syntax = "proto3";

package lumera.audit.v1;

import "cosmos_proto/cosmos.proto";

option go_package = "x/audit/v1/types";

// ActionExpiredEvidenceMetadata is metadata for evidence about an action expiring.
message ActionExpiredEvidenceMetadata {
  // top_10_validator_addresses is the expected validator set for the action's block height.
  repeated string top_10_validator_addresses = 1 [(cosmos_proto.scalar) = "cosmos.ValidatorAddressString"];
}

// ActionFinalizationSignatureFailureEvidenceMetadata is metadata for evidence about an action finalization
// rejected due to invalid signature / signature-derived data.
message ActionFinalizationSignatureFailureEvidenceMetadata {
  repeated string top_10_validator_addresses = 1 [(cosmos_proto.scalar) = "cosmos.ValidatorAddressString"];
}

// ActionFinalizationNotInTop10EvidenceMetadata is metadata for evidence about an action finalization
// rejected because the attempted finalizer is not in the top-10 supernodes.
message ActionFinalizationNotInTop10EvidenceMetadata {
  // top_10_validator_addresses is the expected validator set for the action's block height.
  repeated string top_10_validator_addresses = 1 [(cosmos_proto.scalar) = "cosmos.ValidatorAddressString"];
}

// StorageChallengeFailureEvidenceMetadata is metadata for a storage challenge failure submitted by a challenger.
message StorageChallengeFailureEvidenceMetadata {
  uint64 epoch_id = 1;

  // challenger_supernode_account must match the tx signer (MsgSubmitEvidence.creator).
  // The keeper validates challenger authorization deterministically from the epoch anchor.
  string challenger_supernode_account = 2 [(cosmos_proto.scalar) = "cosmos.AccAddressString"];

  // challenged_supernode_account should match Evidence.subject_address.
  string challenged_supernode_account = 3 [(cosmos_proto.scalar) = "cosmos.AccAddressString"];

  // challenge_id is the deterministic per-(epoch,challenger) identifier (hex-encoded blake3-256).
  string challenge_id = 4;

  // file_key is the challenged file key (typically base58).
  string file_key = 5;

  // failure_type is a short discriminator (e.g. TIMEOUT, INVALID_PROOF, MISSING_FILE).
  string failure_type = 6;

  // transcript_hash is a hash commitment to the off-chain transcript (hex-encoded blake3-256).
  string transcript_hash = 7;
}

// CascadeClientFailureEvidenceMetadata is metadata for client-observed failures
message CascadeClientFailureEvidenceMetadata {
  // flow is a short discriminator for the failed flow segment.
  // Example values: UPLOAD, DOWNLOAD.
  string flow = 1;

  // reporter_component identifies the emitting component.
  // Example values: sn-api-server, sdk-go, sdk-js.
  string reporter_component = 2;

  // target_supernode_account is the implicated supernode account, when known.
  string target_supernode_account = 3 [(cosmos_proto.scalar) = "cosmos.AccAddressString"];

  // details is free-form diagnostic text (e.g. full error traces).
  string details = 4;
}
